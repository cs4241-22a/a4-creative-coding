(()=>{"use strict";class e{constructor(e){this.triggerID=e,this.experience=new o,this.experience.buttonPressHandler.addButtonPressEvent(`btn${e}`,(()=>this.trigger())),this.experience.keyPressHandler.addKeyPress(`${e}`,(()=>this.trigger()))}_setup(){throw new Error("Method '_setup()' must be implemented.")}_playSound(){throw new Error("Method '_playSound()' must be implemented.")}trigger(){this._setup(),this._playSound()}}class t extends e{constructor(e,t){super(t),this.fileName=e,this.loaded=!1,this._loadSound()}_setup(){this.source=this.experience.audioContext.createBufferSource(),this.source.buffer=this.buffer,this.gain=this.experience.audioContext.createGain(),this.source.connect(this.gain),this.gain.connect(this.experience.audioContext.destination)}_playSound(){let e=this.experience.params[`btn${this.triggerID}_gain`];console.log(e);let t=this.experience.audioContext.currentTime;this.gain.gain.setValueAtTime(e,t),this.source.start(this.experience.audioContext.currentTime)}trigger(){if(!this.loaded)throw new Error("Sound not loaded!");this._setup(),this._playSound()}_loadSound(){fetch(`${this.fileName}`,{method:"GET"}).then((e=>{if(!e.ok)throw new Error(`HTTP error, status = ${e.status}`);return e.arrayBuffer()})).then((e=>this.experience.audioContext.decodeAudioData(e))).then((e=>{this.buffer=e,this.loaded=!0}))}}class i extends e{constructor(e){super(e)}_setup(){this.oscillator=this.experience.audioContext.createOscillator(),this.gain=this.experience.audioContext.createGain(),this.oscillator.connect(this.gain),this.gain.connect(this.experience.audioContext.destination)}_playSound(){let e=this.experience.audioContext.currentTime;this.gain.gain.setValueAtTime(1,e),this.gain.gain.exponentialRampToValueAtTime(.001,e+.5*this.experience.params.kickTimeMultiplier),this.oscillator.frequency.setValueAtTime(150*this.experience.params.kickTimeMultiplier,e),this.oscillator.frequency.exponentialRampToValueAtTime(.001,e+.5*this.experience.params.kickTimeMultiplier),this.oscillator.start(e),this.oscillator.stop(e+2*this.experience.params.kickTimeMultiplier)}}class n extends e{constructor(e){super(e)}noiseBuffer(){let e=this.experience.audioContext.sampleRate,t=this.experience.audioContext.createBuffer(1,e,this.experience.audioContext.sampleRate),i=t.getChannelData(0);for(let t=0;t<e;t++)i[t]=2*Math.random()-1;return t}_setup(){this.noise=this.experience.audioContext.createBufferSource(),this.noise.buffer=this.noiseBuffer();let e=this.experience.audioContext.createBiquadFilter();e.type="highpass",e.frequency.value=1e3,this.noise.connect(e),this.noiseEnvelope=this.experience.audioContext.createGain(),e.connect(this.noiseEnvelope),this.noiseEnvelope.connect(this.experience.audioContext.destination),this.oscillator=this.experience.audioContext.createOscillator(),this.oscillator.type="triangle",this.oscillatorEnvelope=this.experience.audioContext.createGain(),this.oscillator.connect(this.oscillatorEnvelope),this.oscillatorEnvelope.connect(this.experience.audioContext.destination)}_playSound(){let e=this.experience.audioContext.currentTime;this.noiseEnvelope.gain.setValueAtTime(1,e),this.noiseEnvelope.gain.exponentialRampToValueAtTime(.01,e+.2),this.noise.start(e),this.oscillator.frequency.setValueAtTime(100,e),this.oscillatorEnvelope.gain.setValueAtTime(.7,e),this.oscillatorEnvelope.gain.exponentialRampToValueAtTime(.01,e+0,1),this.oscillator.start(e),this.oscillator.stop(e+.2),this.noise.stop(e+.2)}}class s{constructor(){this.experience=new o}addButtonPressEvent(e,t){document.getElementById(e).addEventListener("click",(()=>t()))}}class a{constructor(){this.experience=new o,this.keyMap=new Map,window.addEventListener("keydown",(e=>this._onKeyPress(e)))}addKeyPress(e,t){this.keyMap.set(e.toUpperCase().charCodeAt(0),t),this.keyMap.set(this._getNumPadKey(e),t)}removeKeyPress(e){this.keyMap.delete(e)}_onKeyPress(e){let t=e.keyCode,i=this.keyMap.get(t);i&&i()}_getNumPadKey(e){switch(e){case"9":return 33;case"8":return 38;case"7":return 36;case"6":return 39;case"5":return 12;case"4":return 32;case"3":return 34;case"2":return 40;case"1":return 35}return e}}let r=null;class o{constructor(e){if(r)return r;r=this,this.pane=new Tweakpane.Pane,this.tweekPaneInit(),this.kick=null,this.snare=null,this.buttonPressHandler=new s,this.keyPressHandler=new a,this.buttonPressHandler.addButtonPressEvent("start",(()=>this.onInfoPress()))}onInfoPress(){this.audioContext||this.setup(),document.getElementById("information").style.visibility="hidden"}tweekPaneInit(){this.params={kickTimeMultiplier:1,btn9_gain:1,btn8_gain:1,btn7_gain:1,btn6_gain:1,btn5_gain:1,btn4_gain:1,btn3_gain:1,btn2_gain:1,btn1_gain:1},this.pane.addInput(this.params,"kickTimeMultiplier",{min:.1,max:5,step:.1}),this.pane.addInput(this.params,"btn9_gain",{min:.1,max:5,step:.1}),this.pane.addInput(this.params,"btn8_gain",{min:.1,max:5,step:.1}),this.pane.addInput(this.params,"btn7_gain",{min:.1,max:5,step:.1}),this.pane.addInput(this.params,"btn6_gain",{min:.1,max:5,step:.1}),this.pane.addInput(this.params,"btn5_gain",{min:.1,max:5,step:.1}),this.pane.addInput(this.params,"btn4_gain",{min:.1,max:5,step:.1}),this.pane.addInput(this.params,"btn3_gain",{min:.1,max:5,step:.1}),this.pane.addInput(this.params,"btn2_gain",{min:.1,max:5,step:.1}),this.pane.addInput(this.params,"btn1_gain",{min:.1,max:5,step:.1})}setup(){this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.kick=new i("9"),this.snare=new n("8"),this.hihat=new t("hi_hat.wav","7"),this.sizzle=new t("sizzel_snap.wav","6"),this.tunnel=new t("tunnel_shaker.wav","5"),this.low_and_slow=new t("low_and_slow_kick.wav","4"),this.throat=new t("throat_kick.wav","3"),this.fly=new t("fly_hi_hat.wav","2"),this.short=new t("short_and_sweet_hi_hat.wav","1")}}let h=new o("experience");window.experience=h})();
//# sourceMappingURL=bundle.535bbd2ffe74b8fe.js.map